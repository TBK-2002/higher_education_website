<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Student</title>
    <link rel="stylesheet" href="stylesheet.css">
    <script src = "js/add_student_script.js">   </script>
    <script>

    let loadedStudents = loadStudents();
        function validFName(){
    let fName = document.getElementById("Fname").value;
    let regex = /^[A-Z][a-z]*$/;
    if(!regex.test(fName)){
        window.alert("Enter first name that contains: " + '\n'+
        "First letter upper and other lower" + '\n'+
        "No symbols" + '\n'+
        "No numbers");
        return false;
    }
    return true;
   
    }
    function validLName(){
        let lName = document.getElementById("Lname").value;
        let regex = /^[A-Z][a-z]*$/;s
        if(!regex.test(lName)){
        window.alert("Enter last name that contains: "  + '\n'+
            "First letter upper and other lower" +  '\n'+
            "No symbols" + '\n'+
            "No numbers");
        return false;
        }
        return true;

    }
    function validUni(){
        let uName = document.getElementById("Universty").value;
        let regex = /^[a-zA-Z]{2,4}$/;
        if(!regex.test(uName)){
            alert("Enter the Universty abbreviation name: " + '\n'+
            "No symbols" + '\n'+
            "No numbers");
            return false;
        }
        return true;
        
    }
    function validCourses(){
        let course1 = document.getElementById("Course1").value;
        let course2 = document.getElementById("Course2").value;
        let course3 = document.getElementById("Course3").value;
        if(course1 == course2 || course1 == course3 || course2 == course3){
            alert("Please enter different courses");
            return false;
        }
        else{
            return true;
        }
    }
    function validID(){
        let id = (document.getElementById("Id").value);
        let regex=/^[0-9]{8}$/;
        if(regex.test(id)){
            if(loadedStudents[id] == null){
                alert("ID doesn't exist");
                return false;
            }
            else{
                return true;
            }
        }
        else{
            alert("Please enter a valid ID");
            return false;
        }
    }

    function editStudent(){
        if(validFName() && validLName() && validUni() && validCourses() && validID()){
        loadedStudents[document.getElementById("Id").value].fname = document.getElementById("Fname").value;
        loadedStudents[document.getElementById("Id").value].lname = document.getElementById("Lname").value;
        loadedStudents[document.getElementById("Id").value].universty = document.getElementById("Universty").value;
        loadedStudents[document.getElementById("Id").value].gender = document.getElementById("Gender").value;
        loadedStudents[document.getElementById("Id").value].department = document.getElementById("Dep").value;
        loadedStudents[document.getElementById("Id").value].stat = document.getElementById("Status").value;
        loadedStudents[document.getElementById("Id").value].course1 = document.getElementById("Course1").value;
        loadedStudents[document.getElementById("Id").value].course2 = document.getElementById("Course2").value;
        loadedStudents[document.getElementById("Id").value].course3 = document.getElementById("Course3").value;
        loadedStudents[document.getElementById("Id").value].birthday = document.getElementById("Birthday").value;
        localStorage.setItem("students", JSON.stringify(loadedStudents));
        alert("Student edited successfully");
        if(loadedStudents[document.getElementById("Id").value].stat == "Active"){
            window.location.href = "students.html";
        }
        else{
            window.location.href = "inactive_students.html";
        }
      }
      else{
            alert("Please enter valid data");
      }
    }

    function deleteStudent(){
    if(document.getElementById("Id").value == "" || loadedStudents[document.getElementById("Id").value] == null){
        alert("Please enter a valid ID");
        return;
    }
    delete loadedStudents[document.getElementById("Id").value];
    localStorage.setItem("students", JSON.stringify(loadedStudents));
    alert("Student deleted successfully");
    window.location.href = "students.html";
    }

    </script>
</head>
<body>
    <div class="centered">
        <div class="title">
            <label1 for ="id"> Confirm ID:</label1>
            <input type="text" id="Id" name="id" placeholder="Enter your ID">
            <label1 for="fname">First name:</label1>
            <input type="text" id="Fname" name="fname" placeholder="Enter your first name">

            <label1 for="lname">Last name:</label1>
            <input type="text" id="Lname" name="lname" placeholder="Enter your last name">

            <label1 for="universty">Universty:</label1>
            <input type="text" id="Universty" name="universty" placeholder="Universty">

            <label1 for="gender">Gender:</label1>
            <select id = "Gender">
                <option value="0">Select Gender:</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
            </select>

            <label1 for="department">Department:</label1>
            <select id = "Dep" onchange="showOptions()">
                <option value="0">Select Department:</option>
                <option value="IT">IT</option>
                <option value="IS">IS</option>
                <option value="AI">AI</option>
                <option value="CS">CS</option>
                <option value="DS">DS</option>
            </select>

            <label1 for="status">Status:</label1>
            <select id = "Status">
                <option value="0">Select status:</option>
                <option value="Active">Active</option>
                <option value="Inactive">Inactive</option>
            </select>
            

            <label1 for="courses">Courses:</label1>
            <div><select id = "Course1">
                <option value="0">Course 1:</option>
            </select>
            <select id = "Course2">
                <option value="0">Course 2:</option>
            </select>
            <select id = "Course3">
                <option value="0">Course 3:</option>
            </select> 
            </div>


            <label1 for="birthday">Birthdate:</label1>
            <input type="date" id="Birthday" name="birthday" >

            <button onclick="editStudent()" >Save </button>
            <button onclick = "deleteStudent()">Delete Student</button>
        </div>

    </div>
    <ul class="nav_bar">
        <li>
            <a href="main_page.html">Home</a>
        </li>
        <li>
            <a href="main_page.html#Anouncments">Announcements</a>
        </li>
        <li>
            <a href="courses.html">Courses</a>
        </li>
        <li>
            <a href="students.html">Students</a>
        </li>
        <li>
            <a href="departments.html">Departments</a>
        </li>
    </ul>

</body>
</html>